import matplotlib.pyplot as plt
from sklearn.datasets import make_moons
from sklearn.cluster import DBSCAN
%matplotlib inline
import warnings
warnings.filterwarnings("ignore")

#Load Data

X,label=make_moons(n_samples=200,noise=0.1)
X[0:5]

array([[ 1.34790498, -0.45837144],
       [ 0.89835687, -0.71369688],
       [ 0.3635894 , -0.29533902],
       [ 1.91742381, -0.15642384],
       [ 0.25815439,  1.04964896]])

label

array([1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1,
       1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1,
       1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1,
       1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
       0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1,
       0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0,
       1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0,
       0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0,
       1, 0])

model= DBSCAN(eps=0.25,min_samples=10)
model.fit(X)

DBSCAN(algorithm='auto', eps=0.25, leaf_size=30, metric='euclidean',
    metric_params=None, min_samples=10, n_jobs=None, p=None)

model.labels_

array([ 0,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,
        1,  1,  0,  0,  0,  0,  0,  1,  1,  1,  0,  1,  1,  1,  1,  1,  0,
        0,  1,  1,  0,  0,  1,  0,  1,  1,  0,  0,  0,  0,  1,  0,  0,  1,
       -1,  1,  0,  0, -1,  1,  0,  1,  0,  1,  1,  0,  0,  1,  0,  0,  0,
        0,  1,  0,  1,  1,  0,  1,  0,  1,  1,  1,  0,  1,  1,  1,  1,  1,
        1,  0,  1,  1,  1,  1,  0,  1,  0,  0,  1,  1,  0,  0,  1,  0,  0,
        1,  1,  0,  0,  1,  0,  0,  0,  1,  0,  0,  1,  0,  0,  1,  0,  0,
        1,  1,  0,  0,  1,  1,  1,  1,  1,  0,  0,  0,  1,  0,  1,  1,  0,
        1,  0,  1,  0,  1,  0,  1,  1,  1,  1,  0,  0,  0,  0,  0,  1,  1,
        1,  1,  0,  0,  0,  0,  1,  0,  1,  0,  1,  1,  0,  0,  1,  1,  0,
        1,  1,  1,  0,  0,  1,  1,  1,  0,  1,  0,  0,  1,  0,  1,  1,  0,
        0,  0,  1,  1,  1,  1,  1,  0,  0,  1,  1,  0,  1])

#plot the cluster

fig, ax=plt.subplots(figsize=(6,5))
ax.scatter(X[:,0],X[:,1],c=model.labels_)
fig.show()
fig, ax=plt.subplots(figsize=(6,5))
ax.scatter(X[:,0],X[:,1],c=label)
fig.show()

 


